<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8" />
    <title>Cadastro WSIS 2025</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
        :root {
            --bg: #f5f7fb;
            --panel: #ffffff;
            --text: #111111;
            --muted: #374151;
            /* gray-700 */
            --hint: #4b5563;
            /* gray-600 */
            --border: #9ca3af;
            /* gray-400 */
            --focus: #1d4ed8;
            /* blue-700 */
            --btn: #1f2937;
            /* gray-800 */
            --btn-text: #ffffff;
            --error: #b91c1c;
            /* red-700 */
            --success: #065f46;
            /* green-800 */
        }

        * {
            box-sizing: border-box;
        }

        html,
        body {
            height: 100%;
        }

        body {
            margin: 0;
            font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.5;
            display: flex;
            justify-content: center;
            padding: 2rem 1rem;
            height: auto;
        }

        main {
            width: 100%;
            max-width: 520px;
            background: var(--panel);
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, .08);
            padding: 24px;
            margin-top: 2rem;
            margin-bottom: 2rem;
        }

        header {
            display: grid;
            gap: 12px;
            margin-bottom: 24px;
            justify-items: center;
        }


        .skip-link {
            position: absolute;
            top: -40px;
            left: 8px;
            background: var(--btn);
            color: var(--btn-text);
            padding: 8px 12px;
            border-radius: 8px;
            text-decoration: none;
        }

        .skip-link:focus {
            top: 8px;
            outline: 3px solid var(--focus);
            outline-offset: 2px;
        }

        header img {
            max-width: 160px;
            height: auto;
        }

        h1 {
            font-size: 1.5rem;
            margin: 0;
            text-align: center;
            color: var(--muted);
        }

        .required-note {
            margin: 0.25rem 0 1rem;
            font-size: 0.9375rem;
            color: var(--hint);
            text-align: center;
        }

        form {
            display: grid;
            gap: 20px;
        }

        fieldset {
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 16px;
        }

        legend {
            padding: 0 6px;
            font-weight: 600;
            color: var(--muted);
        }

        .field {
            display: grid;
            gap: 6px;
            margin-bottom: 10px;
        }

        label {
            font-weight: 600;
        }

        .req-asterisk {
            color: var(--error);
        }

        .sr-only {
            position: absolute !important;
            height: 1px;
            width: 1px;
            overflow: hidden;
            clip: rect(1px, 1px, 1px, 1px);
            white-space: nowrap;
            border: 0;
            padding: 0;
            margin: -1px;
        }

        input {
            width: 100%;
            padding: 12px 14px;
            font-size: 1rem;
            border: 1px solid var(--border);
            border-radius: 10px;
            background: #fff;
            color: var(--text);
        }

        input::placeholder {
            color: #6b7280;
        }

        input:focus-visible,
        button:focus-visible,
        a:focus-visible {
            outline: 3px solid var(--focus);
            outline-offset: 2px;
        }

        .hint {
            margin: 0;
            font-size: 0.9375rem;
            color: var(--hint);
        }

        .error-message {
            margin: 2px 0 0;
            color: var(--error);
            font-weight: 600;
            font-size: 0.9375rem;
            min-height: 1.1em;
        }

        .error-summary {
            border: 2px solid var(--error);
            background: #fef2f2;
            color: var(--error);
            border-radius: 12px;
            padding: 12px;
            margin-bottom: 12px;
        }

        .error-summary h2 {
            margin: 0 0 8px;
            font-size: 1.1rem;
        }

        .error-summary ul {
            margin: 0;
            padding-left: 18px;
        }

        .error-summary a {
            color: inherit;
        }

        .password-row {
            display: grid;
            grid-template-columns: 1fr auto;
            gap: 8px;
            align-items: center;
        }

        .toggle-pass {
            border: 1px solid var(--border);
            background: #fff;
            color: var(--muted);
            border-radius: 10px;
            padding: 10px 12px;
            cursor: pointer;
        }

        .actions {
            display: grid;
            gap: 10px;
        }

        .btn {
            background: var(--btn);
            color: var(--btn-text);
            border: none;
            border-radius: 12px;
            padding: 12px 16px;
            font-weight: 700;
            font-size: 1rem;
            cursor: pointer;
        }

        .btn:hover {
            filter: brightness(1.05);
        }

        .status {
            border: 2px solid var(--success);
            background: #ecfdf5;
            color: var(--success);
            border-radius: 12px;
            padding: 12px;
            font-weight: 600;
        }
    </style>
</head>

<body>
    <a class="skip-link" href="#conteudo">Pular para o conteúdo principal</a>

    <main id="conteudo">
        <header role="banner">
            <img src="./assets/logo.png" alt="Logo do WSIS 2025" />
            <h1 id="form-title">Cadastro WSIS 2025</h1>
            <p id="instrucao-obrigatorio" class="required-note">
                Campos marcados com <span class="req-asterisk" aria-hidden="true">*</span> são obrigatórios.
            </p>
        </header>

        <!-- Resumo de erros (aparece somente quando houver) -->
        <div id="errorSummary" class="error-summary" role="alert" aria-live="assertive" hidden tabindex="-1"></div>

        <form id="cadastroForm" aria-labelledby="form-title" aria-describedby="instrucao-obrigatorio" autocomplete="on"
            novalidate>
            <fieldset>
                <legend>Dados pessoais</legend>

                <!-- Nome -->
                <div class="field">
                    <label for="nome">Nome completo <span class="req-asterisk" aria-hidden="true">*</span><span
                            class="sr-only"> (obrigatório)</span></label>
                    <input id="nome" name="nome" type="text" required autocomplete="name" inputmode="text"
                        aria-describedby="nome-hint nome-erro" autofocus />
                    <p id="nome-hint" class="hint">Como está no documento de identificação.</p>
                    <p id="nome-erro" class="error-message" role="alert" aria-live="assertive"></p>
                </div>

                <!-- Email -->
                <div class="field">
                    <label for="email">Email <span class="req-asterisk" aria-hidden="true">*</span><span
                            class="sr-only"> (obrigatório)</span></label>
                    <input id="email" name="email" type="email" required autocomplete="email" inputmode="email"
                        aria-describedby="email-hint email-erro" />
                    <p id="email-hint" class="hint">Usaremos para contato e confirmação.</p>
                    <p id="email-erro" class="error-message" role="alert" aria-live="assertive"></p>
                </div>

                <!-- CPF -->
                <div class="field">
                    <label for="cpf">CPF <span class="req-asterisk" aria-hidden="true">*</span><span class="sr-only">
                            (obrigatório)</span></label>
                    <input id="cpf" name="cpf" type="text" required inputmode="numeric" autocomplete="off"
                        aria-describedby="cpf-hint cpf-erro" maxlength="14" />
                    <p id="cpf-hint" class="hint">Somente números (11 dígitos). Você pode digitar com ou sem pontuação.
                    </p>
                    <p id="cpf-erro" class="error-message" role="alert" aria-live="assertive"></p>
                </div>
            </fieldset>

            <fieldset>
                <legend>Acesso</legend>

                <!-- Senha -->
                <div class="field">
                    <label for="senha">Senha <span class="req-asterisk" aria-hidden="true">*</span><span
                            class="sr-only"> (obrigatório)</span></label>
                    <div class="password-row">
                        <input id="senha" name="senha" type="password" required minlength="8"
                            autocomplete="new-password" aria-describedby="senha-hint senha-erro" />
                        <button type="button" class="toggle-pass" id="toggleSenha" aria-controls="senha"
                            aria-pressed="false">
                            Mostrar senha
                        </button>
                    </div>
                    <p id="senha-hint" class="hint">Mínimo de 8 caracteres.</p>
                    <p id="senha-erro" class="error-message" role="alert" aria-live="assertive"></p>
                </div>
            </fieldset>

            <div class="actions">
                <button type="submit" class="btn">Enviar cadastro</button>
                <div id="status" class="status" role="status" aria-live="polite" hidden></div>
            </div>
        </form>
    </main>

    <script>
        // Utilidades de DOM
        const $ = (sel, root = document) => root.querySelector(sel);
        const $$ = (sel, root = document) => Array.from(root.querySelectorAll(sel));

        const form = $('#cadastroForm');
        const summary = $('#errorSummary');
        const statusBox = $('#status');

        const fields = {
            nome: { input: $('#nome'), err: $('#nome-erro') },
            email: { input: $('#email'), err: $('#email-erro') },
            cpf: { input: $('#cpf'), err: $('#cpf-erro') },
            senha: { input: $('#senha'), err: $('#senha-erro') }
        };

        // Máscara leve de CPF (opcional, sem atrapalhar leitor de tela)
        fields.cpf.input.addEventListener('input', (e) => {
            const onlyDigits = e.target.value.replace(/\D/g, '').slice(0, 11);
            // Formata como 000.000.000-00
            const parts = [];
            if (onlyDigits.length > 3) parts.push(onlyDigits.slice(0, 3));
            if (onlyDigits.length > 6) parts.push(onlyDigits.slice(3, 6));
            if (onlyDigits.length > 9) parts.push(onlyDigits.slice(6, 9));
            const remainder = onlyDigits.slice(9, 11);
            let formatted = '';
            if (onlyDigits.length <= 3) formatted = onlyDigits;
            else if (onlyDigits.length <= 6) formatted = `${onlyDigits.slice(0, 3)}.${onlyDigits.slice(3)}`;
            else if (onlyDigits.length <= 9) formatted = `${onlyDigits.slice(0, 3)}.${onlyDigits.slice(3, 6)}.${onlyDigits.slice(6)}`;
            else formatted = `${parts[0]}.${parts[1]}.${parts[2]}-${remainder}`;
            e.target.value = formatted;
        });

        // Validação de CPF (algoritmo oficial)
        function validarCPF(cpfStr) {
            const cpf = cpfStr.replace(/\D/g, '');
            if (cpf.length !== 11) return false;
            if (/^(\d)\1{10}$/.test(cpf)) return false; // 11111111111 etc.

            const calcDV = (base, factor) => {
                let total = 0;
                for (let i = 0; i < base.length; i++) total += parseInt(base[i], 10) * (factor - i);
                const resto = total % 11;
                return resto < 2 ? 0 : 11 - resto;
            };

            const dv1 = calcDV(cpf.slice(0, 9), 10);
            const dv2 = calcDV(cpf.slice(0, 10), 11);
            return dv1 === parseInt(cpf[9], 10) && dv2 === parseInt(cpf[10], 10);
        }

        function setError(fieldKey, message) {
            const { input, err } = fields[fieldKey];
            input.setAttribute('aria-invalid', 'true');
            err.textContent = message;
        }

        function clearError(fieldKey) {
            const { input, err } = fields[fieldKey];
            input.removeAttribute('aria-invalid');
            err.textContent = '';
        }

        function validateField(fieldKey) {
            const { input } = fields[fieldKey];
            const value = (input.value || '').trim();
            clearError(fieldKey);

            switch (fieldKey) {
                case 'nome':
                    if (!value) setError('nome', 'Informe seu nome completo.');
                    break;
                case 'email':
                    if (!value) setError('email', 'Informe seu email.');
                    else if (!/.+@.+\..+/.test(value)) setError('email', 'Digite um email válido, por exemplo: nome@dominio.com.');
                    break;
                case 'cpf':
                    if (!value) setError('cpf', 'Informe seu CPF.');
                    else if (!validarCPF(value)) setError('cpf', 'CPF inválido. Verifique os dígitos.');
                    break;
                case 'senha':
                    if (!value) setError('senha', 'Crie uma senha.');
                    else if (value.length < 8) setError('senha', 'A senha deve ter ao menos 8 caracteres.');
                    break;
            }
        }

        // Validação em blur (feedback progressivo)
        Object.keys(fields).forEach(k => {
            fields[k].input.addEventListener('blur', () => validateField(k));
        });

        // Resumo de erros acessível
        function showSummary(errors) {
            if (!errors.length) {
                summary.hidden = true;
                summary.innerHTML = '';
                return;
            }

            const items = errors.map(({ key, label }) =>
                `<li><a href="#${key}">${label}</a></li>`
            ).join('');

            summary.innerHTML = `
        <h2>Corrija os seguintes erros:</h2>
        <ul>${items}</ul>
      `;
            summary.hidden = false;
            summary.focus();

            // Clique em item do resumo leva o foco ao campo
            $$('a', summary).forEach(a => {
                a.addEventListener('click', (e) => {
                    e.preventDefault();
                    const id = a.getAttribute('href').slice(1);
                    const el = document.getElementById(id);
                    el.focus();
                });
            });
        }

        // Submissão
        form.addEventListener('submit', (e) => {
            e.preventDefault();

            // Limpa status anterior
            statusBox.hidden = true;
            statusBox.textContent = '';

            // Valida todos
            Object.keys(fields).forEach(validateField);

            // Coleta erros
            const errors = Object.keys(fields)
                .filter(k => fields[k].input.getAttribute('aria-invalid') === 'true')
                .map(k => {
                    const label = $('label[for="' + k + '"]').textContent.replace(/\s*\(obrigatório\)\s*/, '').trim();
                    return { key: k, label };
                });

            if (errors.length) {
                showSummary(errors);
                return;
            }

            showSummary([]); // esconde

            // Sucesso: anuncia via live region e foca
            statusBox.textContent = 'Formulário enviado com sucesso!';
            statusBox.hidden = false;
            statusBox.focus();

            // Aqui você poderia enviar ao servidor via fetch(...)
            form.reset();
            Object.keys(fields).forEach(clearError);
        });

        // Alternar visibilidade da senha (acessível)
        const toggleBtn = $('#toggleSenha');
        toggleBtn.addEventListener('click', () => {
            const isText = fields.senha.input.type === 'text';
            fields.senha.input.type = isText ? 'password' : 'text';
            toggleBtn.setAttribute('aria-pressed', String(!isText));
            toggleBtn.textContent = isText ? 'Mostrar senha' : 'Ocultar senha';
            fields.senha.input.focus();
        });
    </script>
</body>

</html>